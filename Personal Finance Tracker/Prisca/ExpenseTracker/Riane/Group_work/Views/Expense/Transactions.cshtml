@model IEnumerable<Group_work.Models.ExpenseTransaction>
@{
    ViewBag.Title = "Transactions";
}

<div class="content-card">
    <div class="card-header">
        <div class="filter-actions flex items-center">
            <div class="filter-tabs">
                <div class="filter-tab" data-filter="All Expenses">All Expenses</div>
                <div class="filter-tab" data-filter="Higher">Higher</div>
                <div class="filter-tab" data-filter="Lower">Lower</div>
                <div class="filter-tab" data-filter="Average">Average</div>
            </div>
        </div>
        <div class="action-buttons flex">
            <a href="@Url.Action("Export", "Expense")" class="export-btn">
                <i class="fas fa-download"></i> Export
            </a>
            <a href="@Url.Action("AddExpense", "Expense")" class="add-expense-btn" style="margin-left: 10px;">
                <i class="fas fa-plus"></i> Add Expense
            </a>
        </div>
    </div>

    <div class="table-filters flex justify-between mb-20">
        <div class="search-product">
            <input type="text" placeholder="Search product..." class="form-control" id="searchInput" />
        </div>
        <div class="filter-options flex">
            <div style="margin-right: 10px;">
                <input type="date" class="form-control" id="dateFilter" />
            </div>
            <div>
                <button class="btn btn-outline-secondary" id="filtersBtn">
                    <i class="fas fa-filter"></i> Filters
                </button>
            </div>
        </div>
    </div>

    <table class="expense-table">
        <thead>
            <tr>
                <th width="5%"></th>
                <th width="5%">ID</th>
                <th width="10%">Transaction ID</th>
                <th width="15%">Category</th>
                <th width="10%">Code</th>
                <th width="10%">Price</th>
                <th width="10%">Status</th>
                <th width="15%">Added</th>
                <th width="10%">Action</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td><input type="checkbox" class="expense-checkbox" /></td>
                    <td>@item.Id</td>
                    <td>@item.TransactionId</td>
                    <td>@item.Category</td>
                    <td>@item.Code</td>
                    <td>$@item.Price.ToString("F2")</td>
                    <td>
                        <span class="status-badge status-@item.Status.ToLower()">@item.Status</span>
                    </td>
                    <td>@item.DateAdded.ToString("dd MMM yyyy")</td>
                    <td class="table-actions">
                        <a href="#" class="action-icon"><i class="fas fa-eye"></i></a>
                        <a href="#" class="action-icon"><i class="fas fa-edit"></i></a>
                        <a href="#" class="action-icon"><i class="fas fa-trash"></i></a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div class="pagination">
        <a href="#">&laquo;</a>
        <a href="#" class="active">1</a>
        <a href="#">2</a>
        <a href="#">3</a>
        <a href="#">4</a>
        <a href="#">5</a>
        <a href="#">&raquo;</a>
    </div>
</div>

@section scripts {
    <script>
        $(document).ready(function() {
            // Search functionality
            $('#searchInput').on('keyup', function() {
                var searchTerm = $(this).val();
                window.location = '@Url.Action("Transactions", "Expense")' + '?searchTerm=' + searchTerm + '&filter=@ViewBag.CurrentFilter';
            });

            // Date filter functionality
            $('#dateFilter').on('change', function() {
                var date = $(this).val();
                if (date) {
                    window.location = '@Url.Action("Transactions", "Expense")' + '?fromDate=' + date + '&filter=@ViewBag.CurrentFilter';
                }
            });

            // If TempData message exists, show it
            @if (TempData["Message"] != null) {
                <text>
                    alert('@TempData["Message"]');
                </text>
            }
        });
    </script>
}